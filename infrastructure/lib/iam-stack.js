"use strict";
/**
 * IAM Stack - Lambda Execution Role and Cross-Account Role Template
 *
 * Generated by: claude-3.5-sonnet
 * Timestamp: 2025-11-12T17:00:00Z
 * Version: 1.0.0
 * Policy Version: v1.0.0
 * Traceability: REQ-9.1, REQ-9.2, REQ-9.4 → DESIGN-001 → TASK-1.3
 * Review Status: Pending
 * Risk Level: Level 2
 *
 * Purpose: Create Lambda execution role in management account with permissions
 * for DynamoDB, S3, SNS, CloudWatch Logs, and STS AssumeRole. Generate
 * cross-account role template for target accounts.
 *
 * Design Decisions:
 * - Least-privilege permissions (only required actions)
 * - External ID for cross-account security
 * - Separate policies for different service interactions
 * - Conditional permissions for write operations (non-prod only)
 */
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
exports.IamStack = void 0;
const cdk = __importStar(require("aws-cdk-lib"));
const iam = __importStar(require("aws-cdk-lib/aws-iam"));
class IamStack extends cdk.Stack {
    constructor(scope, id, props) {
        super(scope, id, props);
        const { externalId, rdsInventoryTable, metricsCacheTable, healthAlertsTable, auditLogTable, approvalsTable, dataBucket } = props;
        // ========================================
        // Lambda Execution Role (Management Account)
        // ========================================
        // Purpose: Role assumed by Lambda functions to access AWS services
        // Requirements: REQ-9.1 (IAM roles), REQ-9.2 (least-privilege)
        this.lambdaExecutionRole = new iam.Role(this, 'LambdaExecutionRole', {
            roleName: 'RDSDashboardLambdaRole',
            assumedBy: new iam.ServicePrincipal('lambda.amazonaws.com'),
            description: 'Execution role for RDS Dashboard Lambda functions',
            managedPolicies: [
                // Basic Lambda execution (CloudWatch Logs)
                iam.ManagedPolicy.fromAwsManagedPolicyName('service-role/AWSLambdaBasicExecutionRole'),
            ],
        });
        // ========================================
        // Policy: DynamoDB Access
        // ========================================
        // Purpose: Read/write access to DynamoDB tables
        const dynamoDbPolicy = new iam.Policy(this, 'DynamoDbPolicy', {
            policyName: 'RDSDashboard-DynamoDB',
            statements: [
                new iam.PolicyStatement({
                    effect: iam.Effect.ALLOW,
                    actions: [
                        'dynamodb:PutItem',
                        'dynamodb:GetItem',
                        'dynamodb:Query',
                        'dynamodb:Scan',
                        'dynamodb:UpdateItem',
                        'dynamodb:DeleteItem',
                        'dynamodb:BatchWriteItem',
                        'dynamodb:BatchGetItem',
                    ],
                    resources: [
                        rdsInventoryTable.tableArn,
                        metricsCacheTable.tableArn,
                        healthAlertsTable.tableArn,
                        auditLogTable.tableArn,
                        approvalsTable.tableArn,
                        // Include GSI ARNs
                        `${rdsInventoryTable.tableArn}/index/*`,
                        `${healthAlertsTable.tableArn}/index/*`,
                        `${auditLogTable.tableArn}/index/*`,
                        `${approvalsTable.tableArn}/index/*`,
                    ],
                }),
            ],
        });
        dynamoDbPolicy.attachToRole(this.lambdaExecutionRole);
        // ========================================
        // Policy: S3 Access
        // ========================================
        // Purpose: Read/write access to data bucket with prefix restrictions
        // Requirements: REQ-6.3 (least-privilege)
        const s3Policy = new iam.Policy(this, 'S3Policy', {
            policyName: 'RDSDashboard-S3',
            statements: [
                // Read access to entire bucket (for listing and getting objects)
                new iam.PolicyStatement({
                    sid: 'AllowS3Read',
                    effect: iam.Effect.ALLOW,
                    actions: [
                        's3:GetObject',
                        's3:ListBucket',
                        's3:GetBucketLocation',
                    ],
                    resources: [
                        dataBucket.bucketArn,
                        `${dataBucket.bucketArn}/*`,
                    ],
                }),
                // Write access restricted to specific prefixes
                new iam.PolicyStatement({
                    sid: 'AllowS3WriteToSpecificPrefixes',
                    effect: iam.Effect.ALLOW,
                    actions: ['s3:PutObject'],
                    resources: [
                        `${dataBucket.bucketArn}/cloudops-templates/*`,
                        `${dataBucket.bucketArn}/cost-reports/*`,
                        `${dataBucket.bucketArn}/compliance-reports/*`,
                        `${dataBucket.bucketArn}/audit-logs/*`,
                        `${dataBucket.bucketArn}/discovery-results/*`,
                    ],
                }),
                // Delete access only for temporary files
                new iam.PolicyStatement({
                    sid: 'AllowS3DeleteTempFiles',
                    effect: iam.Effect.ALLOW,
                    actions: ['s3:DeleteObject'],
                    resources: [
                        `${dataBucket.bucketArn}/temp/*`,
                    ],
                }),
            ],
        });
        s3Policy.attachToRole(this.lambdaExecutionRole);
        // ========================================
        // Policy: SNS Publishing
        // ========================================
        // Purpose: Publish alerts to SNS topics
        const snsPolicy = new iam.Policy(this, 'SnsPolicy', {
            policyName: 'RDSDashboard-SNS',
            statements: [
                new iam.PolicyStatement({
                    effect: iam.Effect.ALLOW,
                    actions: ['sns:Publish'],
                    resources: [
                        `arn:aws:sns:${this.region}:${this.account}:rds-dashboard-alerts`,
                    ],
                }),
            ],
        });
        snsPolicy.attachToRole(this.lambdaExecutionRole);
        // ========================================
        // Policy: STS AssumeRole (Cross-Account)
        // ========================================
        // Purpose: Assume roles in target accounts to access RDS and CloudWatch
        // Requirements: REQ-9.1 (cross-account access), REQ-6.3 (least-privilege)
        // 
        // SECURITY NOTE: This policy uses a wildcard (*) for account IDs.
        // For production deployments, replace with explicit account IDs:
        // 
        // resources: [
        //   'arn:aws:iam::111111111111:role/RDSDashboardCrossAccountRole',
        //   'arn:aws:iam::222222222222:role/RDSDashboardCrossAccountRole',
        //   'arn:aws:iam::333333333333:role/RDSDashboardCrossAccountRole',
        // ]
        // 
        // This can be configured via CDK context or environment variables.
        const stsPolicy = new iam.Policy(this, 'StsPolicy', {
            policyName: 'RDSDashboard-STS',
            statements: [
                new iam.PolicyStatement({
                    sid: 'AllowAssumeRoleInTargetAccounts',
                    effect: iam.Effect.ALLOW,
                    actions: ['sts:AssumeRole'],
                    resources: [
                        // TODO: Replace wildcard with explicit account IDs for production
                        // Role name must be RDSDashboardCrossAccountRole
                        'arn:aws:iam::*:role/RDSDashboardCrossAccountRole',
                    ],
                    conditions: {
                        StringEquals: {
                            'sts:ExternalId': externalId,
                        },
                    },
                }),
            ],
        });
        stsPolicy.attachToRole(this.lambdaExecutionRole);
        // ========================================
        // Policy: CloudWatch Metrics
        // ========================================
        // Purpose: Publish custom metrics
        const cloudWatchPolicy = new iam.Policy(this, 'CloudWatchPolicy', {
            policyName: 'RDSDashboard-CloudWatch',
            statements: [
                new iam.PolicyStatement({
                    effect: iam.Effect.ALLOW,
                    actions: [
                        'cloudwatch:PutMetricData',
                    ],
                    resources: ['*'],
                    conditions: {
                        StringEquals: {
                            'cloudwatch:namespace': 'RDSDashboard',
                        },
                    },
                }),
            ],
        });
        cloudWatchPolicy.attachToRole(this.lambdaExecutionRole);
        // ========================================
        // Policy: RDS Read Access
        // ========================================
        // Purpose: Discover and describe RDS instances in current account
        // Requirements: REQ-1.1 (RDS discovery), REQ-1.2 (metadata extraction)
        const rdsPolicy = new iam.Policy(this, 'RdsPolicy', {
            policyName: 'RDSDashboard-RDS',
            statements: [
                new iam.PolicyStatement({
                    effect: iam.Effect.ALLOW,
                    actions: [
                        'rds:DescribeDBInstances',
                        'rds:DescribeDBClusters',
                        'rds:ListTagsForResource',
                        'rds:DescribeDBSnapshots',
                        'rds:DescribeDBClusterSnapshots',
                    ],
                    resources: ['*'],
                }),
            ],
        });
        rdsPolicy.attachToRole(this.lambdaExecutionRole);
        // ========================================
        // Policy: RDS Operations (Write Access)
        // ========================================
        // Purpose: Execute self-service operations on RDS instances
        // Requirements: REQ-7 (Self-Service Operations), REQ-6.3 (least-privilege)
        // Security: Multi-layered protection with explicit DENY for production
        const rdsOperationsPolicy = new iam.Policy(this, 'RdsOperationsPolicy', {
            policyName: 'RDSDashboard-RDS-Operations',
            statements: [
                // EXPLICIT DENY for production instances (highest priority)
                // This ensures production instances cannot be modified even if other policies allow it
                new iam.PolicyStatement({
                    sid: 'DenyProductionOperations',
                    effect: iam.Effect.DENY,
                    actions: [
                        'rds:CreateDBSnapshot',
                        'rds:CreateDBClusterSnapshot',
                        'rds:RebootDBInstance',
                        'rds:ModifyDBInstance',
                        'rds:ModifyDBCluster',
                        'rds:StartDBInstance',
                        'rds:StopDBInstance',
                        'rds:StartDBCluster',
                        'rds:StopDBCluster',
                    ],
                    resources: ['*'],
                    conditions: {
                        StringEquals: {
                            'aws:ResourceTag/Environment': ['Production', 'Prod', 'PROD', 'production', 'prod'],
                        },
                    },
                }),
                // ALLOW operations on non-production instances only
                new iam.PolicyStatement({
                    sid: 'AllowNonProductionOperations',
                    effect: iam.Effect.ALLOW,
                    actions: [
                        'rds:CreateDBSnapshot',
                        'rds:CreateDBClusterSnapshot',
                        'rds:RebootDBInstance',
                        'rds:ModifyDBInstance',
                        'rds:ModifyDBCluster',
                        'rds:StartDBInstance',
                        'rds:StopDBInstance',
                        'rds:StartDBCluster',
                        'rds:StopDBCluster',
                    ],
                    resources: ['*'],
                    conditions: {
                        StringNotEquals: {
                            'aws:ResourceTag/Environment': ['Production', 'Prod', 'PROD', 'production', 'prod'],
                        },
                    },
                }),
                // Read-only operations (no restrictions needed)
                new iam.PolicyStatement({
                    sid: 'AllowSnapshotDescribe',
                    effect: iam.Effect.ALLOW,
                    actions: [
                        'rds:DescribeDBSnapshots',
                        'rds:DescribeDBClusterSnapshots',
                    ],
                    resources: ['*'],
                }),
            ],
        });
        rdsOperationsPolicy.attachToRole(this.lambdaExecutionRole);
        // ========================================
        // Generate Cross-Account Role Template
        // ========================================
        // Purpose: CloudFormation template for target accounts to deploy
        // Requirements: REQ-9.2 (cross-account roles), REQ-9.4 (external ID)
        this.crossAccountRoleTemplate = this.generateCrossAccountRoleTemplate(externalId);
        // ========================================
        // CloudFormation Outputs
        // ========================================
        new cdk.CfnOutput(this, 'LambdaExecutionRoleArn', {
            value: this.lambdaExecutionRole.roleArn,
            description: 'ARN of Lambda execution role',
            exportName: 'LambdaExecutionRoleArn',
        });
        new cdk.CfnOutput(this, 'LambdaExecutionRoleName', {
            value: this.lambdaExecutionRole.roleName,
            description: 'Name of Lambda execution role',
            exportName: 'LambdaExecutionRoleName',
        });
        new cdk.CfnOutput(this, 'ExternalId', {
            value: externalId,
            description: 'External ID for cross-account role trust policy',
            exportName: 'ExternalId',
        });
    }
    /**
     * Generate CloudFormation template for cross-account role
     * This template should be deployed in each target account
     */
    generateCrossAccountRoleTemplate(externalId) {
        return `
AWSTemplateFormatVersion: '2010-09-09'
Description: 'RDS Dashboard Cross-Account Role - Deploy in target accounts'

Parameters:
  ManagementAccountId:
    Type: String
    Description: AWS Account ID of the management account hosting RDS Dashboard
    AllowedPattern: '^[0-9]{12}$'
  
  ExternalId:
    Type: String
    Description: External ID for secure cross-account access
    Default: '${externalId}'
    NoEcho: true

Resources:
  RDSDashboardCrossAccountRole:
    Type: AWS::IAM::Role
    Properties:
      RoleName: RDSDashboardCrossAccountRole
      Description: 'Cross-account role for RDS Dashboard to access RDS and CloudWatch'
      AssumeRolePolicyDocument:
        Version: '2012-10-17'
        Statement:
          - Effect: Allow
            Principal:
              AWS: !Sub 'arn:aws:iam::\${ManagementAccountId}:role/RDSDashboardLambdaRole-prod'
            Action: 'sts:AssumeRole'
            Condition:
              StringEquals:
                'sts:ExternalId': !Ref ExternalId
      ManagedPolicyArns:
        - !Ref RDSReadOnlyPolicy
        - !Ref CloudWatchReadOnlyPolicy
        - !Ref RDSWriteNonProdPolicy
      Tags:
        - Key: Project
          Value: RDSDashboard
        - Key: ManagedBy
          Value: CloudFormation

  # Policy: RDS Read-Only Access
  RDSReadOnlyPolicy:
    Type: AWS::IAM::ManagedPolicy
    Properties:
      ManagedPolicyName: RDSDashboard-RDS-ReadOnly
      Description: 'Read-only access to RDS for discovery and monitoring'
      PolicyDocument:
        Version: '2012-10-17'
        Statement:
          - Effect: Allow
            Action:
              - 'rds:Describe*'
              - 'rds:ListTagsForResource'
            Resource: '*'

  # Policy: CloudWatch Read-Only Access
  CloudWatchReadOnlyPolicy:
    Type: AWS::IAM::ManagedPolicy
    Properties:
      ManagedPolicyName: RDSDashboard-CloudWatch-ReadOnly
      Description: 'Read-only access to CloudWatch metrics'
      PolicyDocument:
        Version: '2012-10-17'
        Statement:
          - Effect: Allow
            Action:
              - 'cloudwatch:GetMetricStatistics'
              - 'cloudwatch:GetMetricData'
              - 'cloudwatch:ListMetrics'
            Resource: '*'

  # Policy: RDS Write Access (Non-Production Only)
  RDSWriteNonProdPolicy:
    Type: AWS::IAM::ManagedPolicy
    Properties:
      ManagedPolicyName: RDSDashboard-RDS-WriteNonProd
      Description: 'Write access to RDS for self-service operations (non-prod only)'
      PolicyDocument:
        Version: '2012-10-17'
        Statement:
          - Effect: Allow
            Action:
              - 'rds:CreateDBSnapshot'
              - 'rds:RebootDBInstance'
              - 'rds:ModifyDBInstance'
            Resource: '*'
            Condition:
              StringNotEquals:
                'aws:ResourceTag/Environment': 'Production'

Outputs:
  RoleArn:
    Description: ARN of the cross-account role
    Value: !GetAtt RDSDashboardCrossAccountRole.Arn
    Export:
      Name: RDSDashboardCrossAccountRoleArn
  
  RoleName:
    Description: Name of the cross-account role
    Value: !Ref RDSDashboardCrossAccountRole
    Export:
      Name: RDSDashboardCrossAccountRoleName
`;
    }
}
exports.IamStack = IamStack;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaWFtLXN0YWNrLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiaWFtLXN0YWNrLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7R0FvQkc7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUVILGlEQUFtQztBQUNuQyx5REFBMkM7QUFlM0MsTUFBYSxRQUFTLFNBQVEsR0FBRyxDQUFDLEtBQUs7SUFJckMsWUFBWSxLQUFnQixFQUFFLEVBQVUsRUFBRSxLQUFvQjtRQUM1RCxLQUFLLENBQUMsS0FBSyxFQUFFLEVBQUUsRUFBRSxLQUFLLENBQUMsQ0FBQztRQUV4QixNQUFNLEVBQUUsVUFBVSxFQUFFLGlCQUFpQixFQUFFLGlCQUFpQixFQUNoRCxpQkFBaUIsRUFBRSxhQUFhLEVBQUUsY0FBYyxFQUFFLFVBQVUsRUFBRSxHQUFHLEtBQUssQ0FBQztRQUUvRSwyQ0FBMkM7UUFDM0MsNkNBQTZDO1FBQzdDLDJDQUEyQztRQUMzQyxtRUFBbUU7UUFDbkUsK0RBQStEO1FBQy9ELElBQUksQ0FBQyxtQkFBbUIsR0FBRyxJQUFJLEdBQUcsQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFFLHFCQUFxQixFQUFFO1lBQ25FLFFBQVEsRUFBRSx3QkFBd0I7WUFDbEMsU0FBUyxFQUFFLElBQUksR0FBRyxDQUFDLGdCQUFnQixDQUFDLHNCQUFzQixDQUFDO1lBQzNELFdBQVcsRUFBRSxtREFBbUQ7WUFDaEUsZUFBZSxFQUFFO2dCQUNmLDJDQUEyQztnQkFDM0MsR0FBRyxDQUFDLGFBQWEsQ0FBQyx3QkFBd0IsQ0FBQywwQ0FBMEMsQ0FBQzthQUN2RjtTQUNGLENBQUMsQ0FBQztRQUVILDJDQUEyQztRQUMzQywwQkFBMEI7UUFDMUIsMkNBQTJDO1FBQzNDLGdEQUFnRDtRQUNoRCxNQUFNLGNBQWMsR0FBRyxJQUFJLEdBQUcsQ0FBQyxNQUFNLENBQUMsSUFBSSxFQUFFLGdCQUFnQixFQUFFO1lBQzVELFVBQVUsRUFB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VSxFQUFFLHlCQUF5QjtTQUN0QyxDQUFDLENBQUM7UUFFSCxJQUFJLEdBQUcsQ0FBQyxTQUFTLENBQUMsSUFBSSxFQUFFLFlBQVksRUFBRTtZQUNwQyxLQUFLLEVBQUUsVUFBVTtZQUNqQixXQUFXLEVBQUUsaURBQWlEO1lBQzlELFVBQVUsRUFBRSxZQUFZO1NBQ3pCLENBQUMsQ0FBQztJQUNMLENBQUM7SUFFRDs7O09BR0c7SUFDSyxnQ0FBZ0MsQ0FBQyxVQUFrQjtRQUN6RCxPQUFPOzs7Ozs7Ozs7Ozs7O2dCQWFLLFVBQVU7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Q0EyRnpCLENBQUM7SUFDQSxDQUFDO0NBQ0Y7QUFuYUQsNEJBbWFDIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIElBTSBTdGFjayAtIExhbWJkYSBFeGVjdXRpb24gUm9sZSBhbmQgQ3Jvc3MtQWNjb3VudCBSb2xlIFRlbXBsYXRlXHJcbiAqIFxyXG4gKiBHZW5lcmF0ZWQgYnk6IGNsYXVkZS0zLjUtc29ubmV0XHJcbiAqIFRpbWVzdGFtcDogMjAyNS0xMS0xMlQxNzowMDowMFpcclxuICogVmVyc2lvbjogMS4wLjBcclxuICogUG9saWN5IFZlcnNpb246IHYxLjAuMFxyXG4gKiBUcmFjZWFiaWxpdHk6IFJFUS05LjEsIFJFUS05LjIsIFJFUS05LjQg4oaSIERFU0lHTi0wMDEg4oaSIFRBU0stMS4zXHJcbiAqIFJldmlldyBTdGF0dXM6IFBlbmRpbmdcclxuICogUmlzayBMZXZlbDogTGV2ZWwgMlxyXG4gKiBcclxuICogUHVycG9zZTogQ3JlYXRlIExhbWJkYSBleGVjdXRpb24gcm9sZSBpbiBtYW5hZ2VtZW50IGFjY291bnQgd2l0aCBwZXJtaXNzaW9uc1xyXG4gKiBmb3IgRHluYW1vREIsIFMzLCBTTlMsIENsb3VkV2F0Y2ggTG9ncywgYW5kIFNUUyBBc3N1bWVSb2xlLiBHZW5lcmF0ZVxyXG4gKiBjcm9zcy1hY2NvdW50IHJvbGUgdGVtcGxhdGUgZm9yIHRhcmdldCBhY2NvdW50cy5cclxuICogXHJcbiAqIERlc2lnbiBEZWNpc2lvbnM6XHJcbiAqIC0gTGVhc3QtcHJpdmlsZWdlIHBlcm1pc3Npb25zIChvbmx5IHJlcXVpcmVkIGFjdGlvbnMpXHJcbiAqIC0gRXh0ZXJuYWwgSUQgZm9yIGNyb3NzLWFjY291bnQgc2VjdXJpdHlcclxuICogLSBTZXBhcmF0ZSBwb2xpY2llcyBmb3IgZGlmZmVyZW50IHNlcnZpY2UgaW50ZXJhY3Rpb25zXHJcbiAqIC0gQ29uZGl0aW9uYWwgcGVybWlzc2lvbnMgZm9yIHdyaXRlIG9wZXJhdGlvbnMgKG5vbi1wcm9kIG9ubHkpXHJcbiAqL1xyXG5cclxuaW1wb3J0ICogYXMgY2RrIGZyb20gJ2F3cy1jZGstbGliJztcclxuaW1wb3J0ICogYXMgaWFtIGZyb20gJ2F3cy1jZGstbGliL2F3cy1pYW0nO1xyXG5pbXBvcnQgKiBhcyBkeW5hbW9kYiBmcm9tICdhd3MtY2RrLWxpYi9hd3MtZHluYW1vZGInO1xyXG5pbXBvcnQgKiBhcyBzMyBmcm9tICdhd3MtY2RrLWxpYi9hd3MtczMnO1xyXG5pbXBvcnQgeyBDb25zdHJ1Y3QgfSBmcm9tICdjb25zdHJ1Y3RzJztcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgSWFtU3RhY2tQcm9wcyBleHRlbmRzIGNkay5TdGFja1Byb3BzIHtcclxuICByZWFkb25seSBleHRlcm5hbElkOiBzdHJpbmc7XHJcbiAgcmVhZG9ubHkgcmRzSW52ZW50b3J5VGFibGU6IGR5bmFtb2RiLklUYWJsZTtcclxuICByZWFkb25seSBtZXRyaWNzQ2FjaGVUYWJsZTogZHluYW1vZGIuSVRhYmxlO1xyXG4gIHJlYWRvbmx5IGhlYWx0aEFsZXJ0c1RhYmxlOiBkeW5hbW9kYi5JVGFibGU7XHJcbiAgcmVhZG9ubHkgYXVkaXRMb2dUYWJsZTogZHluYW1vZGIuSVRhYmxlO1xyXG4gIHJlYWRvbmx5IGFwcHJvdmFsc1RhYmxlOiBkeW5hbW9kYi5JVGFibGU7XHJcbiAgcmVhZG9ubHkgZGF0YUJ1Y2tldDogczMuSUJ1Y2tldDtcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIElhbVN0YWNrIGV4dGVuZHMgY2RrLlN0YWNrIHtcclxuICBwdWJsaWMgcmVhZG9ubHkgbGFtYmRhRXhlY3V0aW9uUm9sZTogaWFtLlJvbGU7XHJcbiAgcHVibGljIHJlYWRvbmx5IGNyb3NzQWNjb3VudFJvbGVUZW1wbGF0ZTogc3RyaW5nO1xyXG5cclxuICBjb25zdHJ1Y3RvcihzY29wZTogQ29uc3RydWN0LCBpZDogc3RyaW5nLCBwcm9wczogSWFtU3RhY2tQcm9wcykge1xyXG4gICAgc3VwZXIoc2NvcGUsIGlkLCBwcm9wcyk7XHJcblxyXG4gICAgY29uc3QgeyBleHRlcm5hbElkLCByZHNJbnZlbnRvcnlUYWJsZSwgbWV0cmljc0NhY2hlVGFibGUsIFxyXG4gICAgICAgICAgICBoZWFsdGhBbGVydHNUYWJsZSwgYXVkaXRMb2dUYWJsZSwgYXBwcm92YWxzVGFibGUsIGRhdGFCdWNrZXQgfSA9IHByb3BzO1xyXG5cclxuICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuICAgIC8vIExhbWJkYSBFeGVjdXRpb24gUm9sZSAoTWFuYWdlbWVudCBBY2NvdW50KVxyXG4gICAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4gICAgLy8gUHVycG9zZTogUm9sZSBhc3N1bWVkIGJ5IExhbWJkYSBmdW5jdGlvbnMgdG8gYWNjZXNzIEFXUyBzZXJ2aWNlc1xyXG4gICAgLy8gUmVxdWlyZW1lbnRzOiBSRVEtOS4xIChJQU0gcm9sZXMpLCBSRVEtOS4yIChsZWFzdC1wcml2aWxlZ2UpXHJcbiAgICB0aGlzLmxhbWJkYUV4ZWN1dGlvblJvbGUgPSBuZXcgaWFtLlJvbGUodGhpcywgJ0xhbWJkYUV4ZWN1dGlvblJvbGUnLCB7XHJcbiAgICAgIHJvbGVOYW1lOiAnUkRTRGFzaGJvYXJkTGFtYmRhUm9sZScsXHJcbiAgICAgIGFzc3VtZWRCeTogbmV3IGlhbS5TZXJ2aWNlUHJpbmNpcGFsKCdsYW1iZGEuYW1hem9uYXdzLmNvbScpLFxyXG4gICAgICBkZXNjcmlwdGlvbjogJ0V4ZWN1dGlvbiByb2xlIGZvciBSRFMgRGFzaGJvYXJkIExhbWJkYSBmdW5jdGlvbnMnLFxyXG4gICAgICBtYW5hZ2VkUG9saWNpZXM6IFtcclxuICAgICAgICAvLyBCYXNpYyBMYW1iZGEgZXhlY3V0aW9uIChDbG91ZFdhdGNoIExvZ3MpXHJcbiAgICAgICAgaWFtLk1hbmFnZWRQb2xpY3kuZnJvbUF3c01hbmFnZWRQb2xpY3lOYW1lKCdzZXJ2aWNlLXJvbGUvQVdTTGFtYmRhQmFzaWNFeGVjdXRpb25Sb2xlJyksXHJcbiAgICAgIF0sXHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbiAgICAvLyBQb2xpY3k6IER5bmFtb0RCIEFjY2Vzc1xyXG4gICAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4gICAgLy8gUHVycG9zZTogUmVhZC93cml0ZSBhY2Nlc3MgdG8gRHluYW1vREIgdGFibGVzXHJcbiAgICBjb25zdCBkeW5hbW9EYlBvbGljeSA9IG5ldyBpYW0uUG9saWN5KHRoaXMsICdEeW5hbW9EYlBvbGljeScsIHtcclxuICAgICAgcG9saWN5TmFtZTogJ1JEU0Rhc2hib2FyZC1EeW5hbW9EQicsXHJcbiAgICAgIHN0YXRlbWVudHM6IFtcclxuICAgICAgICBuZXcgaWFtLlBvbGljeVN0YXRlbWVudCh7XHJcbiAgICAgICAgICBlZmZlY3Q6IGlhbS5FZmZlY3QuQUxMT1csXHJcbiAgICAgICAgICBhY3Rpb25zOiBbXHJcbiAgICAgICAgICAgICdkeW5hbW9kYjpQdXRJdGVtJyxcclxuICAgICAgICAgICAgJ2R5bmFtb2RiOkdldEl0ZW0nLFxyXG4gICAgICAgICAgICAnZHluYW1vZGI6UXVlcnknLFxyXG4gICAgICAgICAgICAnZHluYW1vZGI6U2NhbicsXHJcbiAgICAgICAgICAgICdkeW5hbW9kYjpVcGRhdGVJdGVtJyxcclxuICAgICAgICAgICAgJ2R5bmFtb2RiOkRlbGV0ZUl0ZW0nLFxyXG4gICAgICAgICAgICAnZHluYW1vZGI6QmF0Y2hXcml0ZUl0ZW0nLFxyXG4gICAgICAgICAgICAnZHluYW1vZGI6QmF0Y2hHZXRJdGVtJyxcclxuICAgICAgICAgIF0sXHJcbiAgICAgICAgICByZXNvdXJjZXM6IFtcclxuICAgICAgICAgICAgcmRzSW52ZW50b3J5VGFibGUudGFibGVBcm4sXHJcbiAgICAgICAgICAgIG1ldHJpY3NDYWNoZVRhYmxlLnRhYmxlQXJuLFxyXG4gICAgICAgICAgICBoZWFsdGhBbGVydHNUYWJsZS50YWJsZUFybixcclxuICAgICAgICAgICAgYXVkaXRMb2dUYWJsZS50YWJsZUFybixcclxuICAgICAgICAgICAgYXBwcm92YWxzVGFibGUudGFibGVBcm4sXHJcbiAgICAgICAgICAgIC8vIEluY2x1ZGUgR1NJIEFSTnNcclxuICAgICAgICAgICAgYCR7cmRzSW52ZW50b3J5VGFibGUudGFibGVBcm59L2luZGV4LypgLFxyXG4gICAgICAgICAgICBgJHtoZWFsdGhBbGVydHNUYWJsZS50YWJsZUFybn0vaW5kZXgvKmAsXHJcbiAgICAgICAgICAgIGAke2F1ZGl0TG9nVGFibGUudGFibGVBcm59L2luZGV4LypgLFxyXG4gICAgICAgICAgICBgJHthcHByb3ZhbHNUYWJsZS50YWJsZUFybn0vaW5kZXgvKmAsXHJcbiAgICAgICAgICBdLFxyXG4gICAgICAgIH0pLFxyXG4gICAgICBdLFxyXG4gICAgfSk7XHJcbiAgICBkeW5hbW9EYlBvbGljeS5hdHRhY2hUb1JvbGUodGhpcy5sYW1iZGFFeGVjdXRpb25Sb2xlKTtcclxuXHJcbiAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbiAgICAvLyBQb2xpY3k6IFMzIEFjY2Vzc1xyXG4gICAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4gICAgLy8gUHVycG9zZTogUmVhZC93cml0ZSBhY2Nlc3MgdG8gZGF0YSBidWNrZXQgd2l0aCBwcmVmaXggcmVzdHJpY3Rpb25zXHJcbiAgICAvLyBSZXF1aXJlbWVudHM6IFJFUS02LjMgKGxlYXN0LXByaXZpbGVnZSlcclxuICAgIGNvbnN0IHMzUG9saWN5ID0gbmV3IGlhbS5Qb2xpY3kodGhpcywgJ1MzUG9saWN5Jywge1xyXG4gICAgICBwb2xpY3lOYW1lOiAnUkRTRGFzaGJvYXJkLVMzJyxcclxuICAgICAgc3RhdGVtZW50czogW1xyXG4gICAgICAgIC8vIFJlYWQgYWNjZXNzIHRvIGVudGlyZSBidWNrZXQgKGZvciBsaXN0aW5nIGFuZCBnZXR0aW5nIG9iamVjdHMpXHJcbiAgICAgICAgbmV3IGlhbS5Qb2xpY3lTdGF0ZW1lbnQoe1xyXG4gICAgICAgICAgc2lkOiAnQWxsb3dTM1JlYWQnLFxyXG4gICAgICAgICAgZWZmZWN0OiBpYW0uRWZmZWN0LkFMTE9XLFxyXG4gICAgICAgICAgYWN0aW9uczogW1xyXG4gICAgICAgICAgICAnczM6R2V0T2JqZWN0JyxcclxuICAgICAgICAgICAgJ3MzOkxpc3RCdWNrZXQnLFxyXG4gICAgICAgICAgICAnczM6R2V0QnVja2V0TG9jYXRpb24nLFxyXG4gICAgICAgICAgXSxcclxuICAgICAgICAgIHJlc291cmNlczogW1xyXG4gICAgICAgICAgICBkYXRhQnVja2V0LmJ1Y2tldEFybixcclxuICAgICAgICAgICAgYCR7ZGF0YUJ1Y2tldC5idWNrZXRBcm59LypgLFxyXG4gICAgICAgICAgXSxcclxuICAgICAgICB9KSxcclxuICAgICAgICAvLyBXcml0ZSBhY2Nlc3MgcmVzdHJpY3RlZCB0byBzcGVjaWZpYyBwcmVmaXhlc1xyXG4gICAgICAgIG5ldyBpYW0uUG9saWN5U3RhdGVtZW50KHtcclxuICAgICAgICAgIHNpZDogJ0FsbG93UzNXcml0ZVRvU3BlY2lmaWNQcmVmaXhlcycsXHJcbiAgICAgICAgICBlZmZlY3Q6IGlhbS5FZmZlY3QuQUxMT1csXHJcbiAgICAgICAgICBhY3Rpb25zOiBbJ3MzOlB1dE9iamVjdCddLFxyXG4gICAgICAgICAgcmVzb3VyY2VzOiBbXHJcbiAgICAgICAgICAgIGAke2RhdGFCdWNrZXQuYnVja2V0QXJufS9jbG91ZG9wcy10ZW1wbGF0ZXMvKmAsXHJcbiAgICAgICAgICAgIGAke2RhdGFCdWNrZXQuYnVja2V0QXJufS9jb3N0LXJlcG9ydHMvKmAsXHJcbiAgICAgICAgICAgIGAke2RhdGFCdWNrZXQuYnVja2V0QXJufS9jb21wbGlhbmNlLXJlcG9ydHMvKmAsXHJcbiAgICAgICAgICAgIGAke2RhdGFCdWNrZXQuYnVja2V0QXJufS9hdWRpdC1sb2dzLypgLFxyXG4gICAgICAgICAgICBgJHtkYXRhQnVja2V0LmJ1Y2tldEFybn0vZGlzY292ZXJ5LXJlc3VsdHMvKmAsXHJcbiAgICAgICAgICBdLFxyXG4gICAgICAgIH0pLFxyXG4gICAgICAgIC8vIERlbGV0ZSBhY2Nlc3Mgb25seSBmb3IgdGVtcG9yYXJ5IGZpbGVzXHJcbiAgICAgICAgbmV3IGlhbS5Qb2xpY3lTdGF0ZW1lbnQoe1xyXG4gICAgICAgICAgc2lkOiAnQWxsb3dTM0RlbGV0ZVRlbXBGaWxlcycsXHJcbiAgICAgICAgICBlZmZlY3Q6IGlhbS5FZmZlY3QuQUxMT1csXHJcbiAgICAgICAgICBhY3Rpb25zOiBbJ3MzOkRlbGV0ZU9iamVjdCddLFxyXG4gICAgICAgICAgcmVzb3VyY2VzOiBbXHJcbiAgICAgICAgICAgIGAke2RhdGFCdWNrZXQuYnVja2V0QXJufS90ZW1wLypgLFxyXG4gICAgICAgICAgXSxcclxuICAgICAgICB9KSxcclxuICAgICAgXSxcclxuICAgIH0pO1xyXG4gICAgczNQb2xpY3kuYXR0YWNoVG9Sb2xlKHRoaXMubGFtYmRhRXhlY3V0aW9uUm9sZSk7XHJcblxyXG4gICAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4gICAgLy8gUG9saWN5OiBTTlMgUHVibGlzaGluZ1xyXG4gICAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4gICAgLy8gUHVycG9zZTogUHVibGlzaCBhbGVydHMgdG8gU05TIHRvcGljc1xyXG4gICAgY29uc3Qgc25zUG9saWN5ID0gbmV3IGlhbS5Qb2xpY3kodGhpcywgJ1Nuc1BvbGljeScsIHtcclxuICAgICAgcG9saWN5TmFtZTogJ1JEU0Rhc2hib2FyZC1TTlMnLFxyXG4gICAgICBzdGF0ZW1lbnRzOiBbXHJcbiAgICAgICAgbmV3IGlhbS5Qb2xpY3lTdGF0ZW1lbnQoe1xyXG4gICAgICAgICAgZWZmZWN0OiBpYW0uRWZmZWN0LkFMTE9XLFxyXG4gICAgICAgICAgYWN0aW9uczogWydzbnM6UHVibGlzaCddLFxyXG4gICAgICAgICAgcmVzb3VyY2VzOiBbXHJcbiAgICAgICAgICAgIGBhcm46YXdzOnNuczoke3RoaXMucmVnaW9ufToke3RoaXMuYWNjb3VudH06cmRzLWRhc2hib2FyZC1hbGVydHNgLFxyXG4gICAgICAgICAgXSxcclxuICAgICAgICB9KSxcclxuICAgICAgXSxcclxuICAgIH0pO1xyXG4gICAgc25zUG9saWN5LmF0dGFjaFRvUm9sZSh0aGlzLmxhbWJkYUV4ZWN1dGlvblJvbGUpO1xyXG5cclxuICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuICAgIC8vIFBvbGljeTogU1RTIEFzc3VtZVJvbGUgKENyb3NzLUFjY291bnQpXHJcbiAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbiAgICAvLyBQdXJwb3NlOiBBc3N1bWUgcm9sZXMgaW4gdGFyZ2V0IGFjY291bnRzIHRvIGFjY2VzcyBSRFMgYW5kIENsb3VkV2F0Y2hcclxuICAgIC8vIFJlcXVpcmVtZW50czogUkVRLTkuMSAoY3Jvc3MtYWNjb3VudCBhY2Nlc3MpLCBSRVEtNi4zIChsZWFzdC1wcml2aWxlZ2UpXHJcbiAgICAvLyBcclxuICAgIC8vIFNFQ1VSSVRZIE5PVEU6IFRoaXMgcG9saWN5IHVzZXMgYSB3aWxkY2FyZCAoKikgZm9yIGFjY291bnQgSURzLlxyXG4gICAgLy8gRm9yIHByb2R1Y3Rpb24gZGVwbG95bWVudHMsIHJlcGxhY2Ugd2l0aCBleHBsaWNpdCBhY2NvdW50IElEczpcclxuICAgIC8vIFxyXG4gICAgLy8gcmVzb3VyY2VzOiBbXHJcbiAgICAvLyAgICdhcm46YXdzOmlhbTo6MTExMTExMTExMTExOnJvbGUvUkRTRGFzaGJvYXJkQ3Jvc3NBY2NvdW50Um9sZScsXHJcbiAgICAvLyAgICdhcm46YXdzOmlhbTo6MjIyMjIyMjIyMjIyOnJvbGUvUkRTRGFzaGJvYXJkQ3Jvc3NBY2NvdW50Um9sZScsXHJcbiAgICAvLyAgICdhcm46YXdzOmlhbTo6MzMzMzMzMzMzMzMzOnJvbGUvUkRTRGFzaGJvYXJkQ3Jvc3NBY2NvdW50Um9sZScsXHJcbiAgICAvLyBdXHJcbiAgICAvLyBcclxuICAgIC8vIFRoaXMgY2FuIGJlIGNvbmZpZ3VyZWQgdmlhIENESyBjb250ZXh0IG9yIGVudmlyb25tZW50IHZhcmlhYmxlcy5cclxuICAgIGNvbnN0IHN0c1BvbGljeSA9IG5ldyBpYW0uUG9saWN5KHRoaXMsICdTdHNQb2xpY3knLCB7XHJcbiAgICAgIHBvbGljeU5hbWU6ICdSRFNEYXNoYm9hcmQtU1RTJyxcclxuICAgICAgc3RhdGVtZW50czogW1xyXG4gICAgICAgIG5ldyBpYW0uUG9saWN5U3RhdGVtZW50KHtcclxuICAgICAgICAgIHNpZDogJ0FsbG93QXNzdW1lUm9sZUluVGFyZ2V0QWNjb3VudHMnLFxyXG4gICAgICAgICAgZWZmZWN0OiBpYW0uRWZmZWN0LkFMTE9XLFxyXG4gICAgICAgICAgYWN0aW9uczogWydzdHM6QXNzdW1lUm9sZSddLFxyXG4gICAgICAgICAgcmVzb3VyY2VzOiBbXHJcbiAgICAgICAgICAgIC8vIFRPRE86IFJlcGxhY2Ugd2lsZGNhcmQgd2l0aCBleHBsaWNpdCBhY2NvdW50IElEcyBmb3IgcHJvZHVjdGlvblxyXG4gICAgICAgICAgICAvLyBSb2xlIG5hbWUgbXVzdCBiZSBSRFNEYXNoYm9hcmRDcm9zc0FjY291bnRSb2xlXHJcbiAgICAgICAgICAgICdhcm46YXdzOmlhbTo6Kjpyb2xlL1JEU0Rhc2hib2FyZENyb3NzQWNjb3VudFJvbGUnLFxyXG4gICAgICAgICAgXSxcclxuICAgICAgICAgIGNvbmRpdGlvbnM6IHtcclxuICAgICAgICAgICAgU3RyaW5nRXF1YWxzOiB7XHJcbiAgICAgICAgICAgICAgJ3N0czpFeHRlcm5hbElkJzogZXh0ZXJuYWxJZCxcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgfSksXHJcbiAgICAgIF0sXHJcbiAgICB9KTtcclxuICAgIHN0c1BvbGljeS5hdHRhY2hUb1JvbGUodGhpcy5sYW1iZGFFeGVjdXRpb25Sb2xlKTtcclxuXHJcbiAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbiAgICAvLyBQb2xpY3k6IENsb3VkV2F0Y2ggTWV0cmljc1xyXG4gICAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4gICAgLy8gUHVycG9zZTogUHVibGlzaCBjdXN0b20gbWV0cmljc1xyXG4gICAgY29uc3QgY2xvdWRXYXRjaFBvbGljeSA9IG5ldyBpYW0uUG9saWN5KHRoaXMsICdDbG91ZFdhdGNoUG9saWN5Jywge1xyXG4gICAgICBwb2xpY3lOYW1lOiAnUkRTRGFzaGJvYXJkLUNsb3VkV2F0Y2gnLFxyXG4gICAgICBzdGF0ZW1lbnRzOiBbXHJcbiAgICAgICAgbmV3IGlhbS5Qb2xpY3lTdGF0ZW1lbnQoe1xyXG4gICAgICAgICAgZWZmZWN0OiBpYW0uRWZmZWN0LkFMTE9XLFxyXG4gICAgICAgICAgYWN0aW9uczogW1xyXG4gICAgICAgICAgICAnY2xvdWR3YXRjaDpQdXRNZXRyaWNEYXRhJyxcclxuICAgICAgICAgIF0sXHJcbiAgICAgICAgICByZXNvdXJjZXM6IFsnKiddLFxyXG4gICAgICAgICAgY29uZGl0aW9uczoge1xyXG4gICAgICAgICAgICBTdHJpbmdFcXVhbHM6IHtcclxuICAgICAgICAgICAgICAnY2xvdWR3YXRjaDpuYW1lc3BhY2UnOiAnUkRTRGFzaGJvYXJkJyxcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgfSksXHJcbiAgICAgIF0sXHJcbiAgICB9KTtcclxuICAgIGNsb3VkV2F0Y2hQb2xpY3kuYXR0YWNoVG9Sb2xlKHRoaXMubGFtYmRhRXhlY3V0aW9uUm9sZSk7XHJcblxyXG4gICAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4gICAgLy8gUG9saWN5OiBSRFMgUmVhZCBBY2Nlc3NcclxuICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuICAgIC8vIFB1cnBvc2U6IERpc2NvdmVyIGFuZCBkZXNjcmliZSBSRFMgaW5zdGFuY2VzIGluIGN1cnJlbnQgYWNjb3VudFxyXG4gICAgLy8gUmVxdWlyZW1lbnRzOiBSRVEtMS4xIChSRFMgZGlzY292ZXJ5KSwgUkVRLTEuMiAobWV0YWRhdGEgZXh0cmFjdGlvbilcclxuICAgIGNvbnN0IHJkc1BvbGljeSA9IG5ldyBpYW0uUG9saWN5KHRoaXMsICdSZHNQb2xpY3knLCB7XHJcbiAgICAgIHBvbGljeU5hbWU6ICdSRFNEYXNoYm9hcmQtUkRTJyxcclxuICAgICAgc3RhdGVtZW50czogW1xyXG4gICAgICAgIG5ldyBpYW0uUG9saWN5U3RhdGVtZW50KHtcclxuICAgICAgICAgIGVmZmVjdDogaWFtLkVmZmVjdC5BTExPVyxcclxuICAgICAgICAgIGFjdGlvbnM6IFtcclxuICAgICAgICAgICAgJ3JkczpEZXNjcmliZURCSW5zdGFuY2VzJyxcclxuICAgICAgICAgICAgJ3JkczpEZXNjcmliZURCQ2x1c3RlcnMnLFxyXG4gICAgICAgICAgICAncmRzOkxpc3RUYWdzRm9yUmVzb3VyY2UnLFxyXG4gICAgICAgICAgICAncmRzOkRlc2NyaWJlREJTbmFwc2hvdHMnLFxyXG4gICAgICAgICAgICAncmRzOkRlc2NyaWJlREJDbHVzdGVyU25hcHNob3RzJyxcclxuICAgICAgICAgIF0sXHJcbiAgICAgICAgICByZXNvdXJjZXM6IFsnKiddLFxyXG4gICAgICAgIH0pLFxyXG4gICAgICBdLFxyXG4gICAgfSk7XHJcbiAgICByZHNQb2xpY3kuYXR0YWNoVG9Sb2xlKHRoaXMubGFtYmRhRXhlY3V0aW9uUm9sZSk7XHJcblxyXG4gICAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4gICAgLy8gUG9saWN5OiBSRFMgT3BlcmF0aW9ucyAoV3JpdGUgQWNjZXNzKVxyXG4gICAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4gICAgLy8gUHVycG9zZTogRXhlY3V0ZSBzZWxmLXNlcnZpY2Ugb3BlcmF0aW9ucyBvbiBSRFMgaW5zdGFuY2VzXHJcbiAgICAvLyBSZXF1aXJlbWVudHM6IFJFUS03IChTZWxmLVNlcnZpY2UgT3BlcmF0aW9ucyksIFJFUS02LjMgKGxlYXN0LXByaXZpbGVnZSlcclxuICAgIC8vIFNlY3VyaXR5OiBNdWx0aS1sYXllcmVkIHByb3RlY3Rpb24gd2l0aCBleHBsaWNpdCBERU5ZIGZvciBwcm9kdWN0aW9uXHJcbiAgICBjb25zdCByZHNPcGVyYXRpb25zUG9saWN5ID0gbmV3IGlhbS5Qb2xpY3kodGhpcywgJ1Jkc09wZXJhdGlvbnNQb2xpY3knLCB7XHJcbiAgICAgIHBvbGljeU5hbWU6ICdSRFNEYXNoYm9hcmQtUkRTLU9wZXJhdGlvbnMnLFxyXG4gICAgICBzdGF0ZW1lbnRzOiBbXHJcbiAgICAgICAgLy8gRVhQTElDSVQgREVOWSBmb3IgcHJvZHVjdGlvbiBpbnN0YW5jZXMgKGhpZ2hlc3QgcHJpb3JpdHkpXHJcbiAgICAgICAgLy8gVGhpcyBlbnN1cmVzIHByb2R1Y3Rpb24gaW5zdGFuY2VzIGNhbm5vdCBiZSBtb2RpZmllZCBldmVuIGlmIG90aGVyIHBvbGljaWVzIGFsbG93IGl0XHJcbiAgICAgICAgbmV3IGlhbS5Qb2xpY3lTdGF0ZW1lbnQoe1xyXG4gICAgICAgICAgc2lkOiAnRGVueVByb2R1Y3Rpb25PcGVyYXRpb25zJyxcclxuICAgICAgICAgIGVmZmVjdDogaWFtLkVmZmVjdC5ERU5ZLFxyXG4gICAgICAgICAgYWN0aW9uczogW1xyXG4gICAgICAgICAgICAncmRzOkNyZWF0ZURCU25hcHNob3QnLFxyXG4gICAgICAgICAgICAncmRzOkNyZWF0ZURCQ2x1c3RlclNuYXBzaG90JyxcclxuICAgICAgICAgICAgJ3JkczpSZWJvb3REQkluc3RhbmNlJyxcclxuICAgICAgICAgICAgJ3JkczpNb2RpZnlEQkluc3RhbmNlJyxcclxuICAgICAgICAgICAgJ3JkczpNb2RpZnlEQkNsdXN0ZXInLFxyXG4gICAgICAgICAgICAncmRzOlN0YXJ0REJJbnN0YW5jZScsXHJcbiAgICAgICAgICAgICdyZHM6U3RvcERCSW5zdGFuY2UnLFxyXG4gICAgICAgICAgICAncmRzOlN0YXJ0REJDbHVzdGVyJyxcclxuICAgICAgICAgICAgJ3JkczpTdG9wREJDbHVzdGVyJyxcclxuICAgICAgICAgIF0sXHJcbiAgICAgICAgICByZXNvdXJjZXM6IFsnKiddLFxyXG4gICAgICAgICAgY29uZGl0aW9uczoge1xyXG4gICAgICAgICAgICBTdHJpbmdFcXVhbHM6IHtcclxuICAgICAgICAgICAgICAnYXdzOlJlc291cmNlVGFnL0Vudmlyb25tZW50JzogWydQcm9kdWN0aW9uJywgJ1Byb2QnLCAnUFJPRCcsICdwcm9kdWN0aW9uJywgJ3Byb2QnXSxcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgfSksXHJcbiAgICAgICAgLy8gQUxMT1cgb3BlcmF0aW9ucyBvbiBub24tcHJvZHVjdGlvbiBpbnN0YW5jZXMgb25seVxyXG4gICAgICAgIG5ldyBpYW0uUG9saWN5U3RhdGVtZW50KHtcclxuICAgICAgICAgIHNpZDogJ0FsbG93Tm9uUHJvZHVjdGlvbk9wZXJhdGlvbnMnLFxyXG4gICAgICAgICAgZWZmZWN0OiBpYW0uRWZmZWN0LkFMTE9XLFxyXG4gICAgICAgICAgYWN0aW9uczogW1xyXG4gICAgICAgICAgICAncmRzOkNyZWF0ZURCU25hcHNob3QnLFxyXG4gICAgICAgICAgICAncmRzOkNyZWF0ZURCQ2x1c3RlclNuYXBzaG90JyxcclxuICAgICAgICAgICAgJ3JkczpSZWJvb3REQkluc3RhbmNlJyxcclxuICAgICAgICAgICAgJ3JkczpNb2RpZnlEQkluc3RhbmNlJyxcclxuICAgICAgICAgICAgJ3JkczpNb2RpZnlEQkNsdXN0ZXInLFxyXG4gICAgICAgICAgICAncmRzOlN0YXJ0REJJbnN0YW5jZScsXHJcbiAgICAgICAgICAgICdyZHM6U3RvcERCSW5zdGFuY2UnLFxyXG4gICAgICAgICAgICAncmRzOlN0YXJ0REJDbHVzdGVyJyxcclxuICAgICAgICAgICAgJ3JkczpTdG9wREJDbHVzdGVyJyxcclxuICAgICAgICAgIF0sXHJcbiAgICAgICAgICByZXNvdXJjZXM6IFsnKiddLFxyXG4gICAgICAgICAgY29uZGl0aW9uczoge1xyXG4gICAgICAgICAgICBTdHJpbmdOb3RFcXVhbHM6IHtcclxuICAgICAgICAgICAgICAnYXdzOlJlc291cmNlVGFnL0Vudmlyb25tZW50JzogWydQcm9kdWN0aW9uJywgJ1Byb2QnLCAnUFJPRCcsICdwcm9kdWN0aW9uJywgJ3Byb2QnXSxcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgfSksXHJcbiAgICAgICAgLy8gUmVhZC1vbmx5IG9wZXJhdGlvbnMgKG5vIHJlc3RyaWN0aW9ucyBuZWVkZWQpXHJcbiAgICAgICAgbmV3IGlhbS5Qb2xpY3lTdGF0ZW1lbnQoe1xyXG4gICAgICAgICAgc2lkOiAnQWxsb3dTbmFwc2hvdERlc2NyaWJlJyxcclxuICAgICAgICAgIGVmZmVjdDogaWFtLkVmZmVjdC5BTExPVyxcclxuICAgICAgICAgIGFjdGlvbnM6IFtcclxuICAgICAgICAgICAgJ3JkczpEZXNjcmliZURCU25hcHNob3RzJyxcclxuICAgICAgICAgICAgJ3JkczpEZXNjcmliZURCQ2x1c3RlclNuYXBzaG90cycsXHJcbiAgICAgICAgICBdLFxyXG4gICAgICAgICAgcmVzb3VyY2VzOiBbJyonXSxcclxuICAgICAgICB9KSxcclxuICAgICAgXSxcclxuICAgIH0pO1xyXG4gICAgcmRzT3BlcmF0aW9uc1BvbGljeS5hdHRhY2hUb1JvbGUodGhpcy5sYW1iZGFFeGVjdXRpb25Sb2xlKTtcclxuXHJcbiAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbiAgICAvLyBHZW5lcmF0ZSBDcm9zcy1BY2NvdW50IFJvbGUgVGVtcGxhdGVcclxuICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuICAgIC8vIFB1cnBvc2U6IENsb3VkRm9ybWF0aW9uIHRlbXBsYXRlIGZvciB0YXJnZXQgYWNjb3VudHMgdG8gZGVwbG95XHJcbiAgICAvLyBSZXF1aXJlbWVudHM6IFJFUS05LjIgKGNyb3NzLWFjY291bnQgcm9sZXMpLCBSRVEtOS40IChleHRlcm5hbCBJRClcclxuICAgIHRoaXMuY3Jvc3NBY2NvdW50Um9sZVRlbXBsYXRlID0gdGhpcy5nZW5lcmF0ZUNyb3NzQWNjb3VudFJvbGVUZW1wbGF0ZShleHRlcm5hbElkKTtcclxuXHJcbiAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbiAgICAvLyBDbG91ZEZvcm1hdGlvbiBPdXRwdXRzXHJcbiAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbiAgICBuZXcgY2RrLkNmbk91dHB1dCh0aGlzLCAnTGFtYmRhRXhlY3V0aW9uUm9sZUFybicsIHtcclxuICAgICAgdmFsdWU6IHRoaXMubGFtYmRhRXhlY3V0aW9uUm9sZS5yb2xlQXJuLFxyXG4gICAgICBkZXNjcmlwdGlvbjogJ0FSTiBvZiBMYW1iZGEgZXhlY3V0aW9uIHJvbGUnLFxyXG4gICAgICBleHBvcnROYW1lOiAnTGFtYmRhRXhlY3V0aW9uUm9sZUFybicsXHJcbiAgICB9KTtcclxuXHJcbiAgICBuZXcgY2RrLkNmbk91dHB1dCh0aGlzLCAnTGFtYmRhRXhlY3V0aW9uUm9sZU5hbWUnLCB7XHJcbiAgICAgIHZhbHVlOiB0aGlzLmxhbWJkYUV4ZWN1dGlvblJvbGUucm9sZU5hbWUsXHJcbiAgICAgIGRlc2NyaXB0aW9uOiAnTmFtZSBvZiBMYW1iZGEgZXhlY3V0aW9uIHJvbGUnLFxyXG4gICAgICBleHBvcnROYW1lOiAnTGFtYmRhRXhlY3V0aW9uUm9sZU5hbWUnLFxyXG4gICAgfSk7XHJcblxyXG4gICAgbmV3IGNkay5DZm5PdXRwdXQodGhpcywgJ0V4dGVybmFsSWQnLCB7XHJcbiAgICAgIHZhbHVlOiBleHRlcm5hbElkLFxyXG4gICAgICBkZXNjcmlwdGlvbjogJ0V4dGVybmFsIElEIGZvciBjcm9zcy1hY2NvdW50IHJvbGUgdHJ1c3QgcG9saWN5JyxcclxuICAgICAgZXhwb3J0TmFtZTogJ0V4dGVybmFsSWQnLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZW5lcmF0ZSBDbG91ZEZvcm1hdGlvbiB0ZW1wbGF0ZSBmb3IgY3Jvc3MtYWNjb3VudCByb2xlXHJcbiAgICogVGhpcyB0ZW1wbGF0ZSBzaG91bGQgYmUgZGVwbG95ZWQgaW4gZWFjaCB0YXJnZXQgYWNjb3VudFxyXG4gICAqL1xyXG4gIHByaXZhdGUgZ2VuZXJhdGVDcm9zc0FjY291bnRSb2xlVGVtcGxhdGUoZXh0ZXJuYWxJZDogc3RyaW5nKTogc3RyaW5nIHtcclxuICAgIHJldHVybiBgXHJcbkFXU1RlbXBsYXRlRm9ybWF0VmVyc2lvbjogJzIwMTAtMDktMDknXHJcbkRlc2NyaXB0aW9uOiAnUkRTIERhc2hib2FyZCBDcm9zcy1BY2NvdW50IFJvbGUgLSBEZXBsb3kgaW4gdGFyZ2V0IGFjY291bnRzJ1xyXG5cclxuUGFyYW1ldGVyczpcclxuICBNYW5hZ2VtZW50QWNjb3VudElkOlxyXG4gICAgVHlwZTogU3RyaW5nXHJcbiAgICBEZXNjcmlwdGlvbjogQVdTIEFjY291bnQgSUQgb2YgdGhlIG1hbmFnZW1lbnQgYWNjb3VudCBob3N0aW5nIFJEUyBEYXNoYm9hcmRcclxuICAgIEFsbG93ZWRQYXR0ZXJuOiAnXlswLTldezEyfSQnXHJcbiAgXHJcbiAgRXh0ZXJuYWxJZDpcclxuICAgIFR5cGU6IFN0cmluZ1xyXG4gICAgRGVzY3JpcHRpb246IEV4dGVybmFsIElEIGZvciBzZWN1cmUgY3Jvc3MtYWNjb3VudCBhY2Nlc3NcclxuICAgIERlZmF1bHQ6ICcke2V4dGVybmFsSWR9J1xyXG4gICAgTm9FY2hvOiB0cnVlXHJcblxyXG5SZXNvdXJjZXM6XHJcbiAgUkRTRGFzaGJvYXJkQ3Jvc3NBY2NvdW50Um9sZTpcclxuICAgIFR5cGU6IEFXUzo6SUFNOjpSb2xlXHJcbiAgICBQcm9wZXJ0aWVzOlxyXG4gICAgICBSb2xlTmFtZTogUkRTRGFzaGJvYXJkQ3Jvc3NBY2NvdW50Um9sZVxyXG4gICAgICBEZXNjcmlwdGlvbjogJ0Nyb3NzLWFjY291bnQgcm9sZSBmb3IgUkRTIERhc2hib2FyZCB0byBhY2Nlc3MgUkRTIGFuZCBDbG91ZFdhdGNoJ1xyXG4gICAgICBBc3N1bWVSb2xlUG9saWN5RG9jdW1lbnQ6XHJcbiAgICAgICAgVmVyc2lvbjogJzIwMTItMTAtMTcnXHJcbiAgICAgICAgU3RhdGVtZW50OlxyXG4gICAgICAgICAgLSBFZmZlY3Q6IEFsbG93XHJcbiAgICAgICAgICAgIFByaW5jaXBhbDpcclxuICAgICAgICAgICAgICBBV1M6ICFTdWIgJ2Fybjphd3M6aWFtOjpcXCR7TWFuYWdlbWVudEFjY291bnRJZH06cm9sZS9SRFNEYXNoYm9hcmRMYW1iZGFSb2xlLXByb2QnXHJcbiAgICAgICAgICAgIEFjdGlvbjogJ3N0czpBc3N1bWVSb2xlJ1xyXG4gICAgICAgICAgICBDb25kaXRpb246XHJcbiAgICAgICAgICAgICAgU3RyaW5nRXF1YWxzOlxyXG4gICAgICAgICAgICAgICAgJ3N0czpFeHRlcm5hbElkJzogIVJlZiBFeHRlcm5hbElkXHJcbiAgICAgIE1hbmFnZWRQb2xpY3lBcm5zOlxyXG4gICAgICAgIC0gIVJlZiBSRFNSZWFkT25seVBvbGljeVxyXG4gICAgICAgIC0gIVJlZiBDbG91ZFdhdGNoUmVhZE9ubHlQb2xpY3lcclxuICAgICAgICAtICFSZWYgUkRTV3JpdGVOb25Qcm9kUG9saWN5XHJcbiAgICAgIFRhZ3M6XHJcbiAgICAgICAgLSBLZXk6IFByb2plY3RcclxuICAgICAgICAgIFZhbHVlOiBSRFNEYXNoYm9hcmRcclxuICAgICAgICAtIEtleTogTWFuYWdlZEJ5XHJcbiAgICAgICAgICBWYWx1ZTogQ2xvdWRGb3JtYXRpb25cclxuXHJcbiAgIyBQb2xpY3k6IFJEUyBSZWFkLU9ubHkgQWNjZXNzXHJcbiAgUkRTUmVhZE9ubHlQb2xpY3k6XHJcbiAgICBUeXBlOiBBV1M6OklBTTo6TWFuYWdlZFBvbGljeVxyXG4gICAgUHJvcGVydGllczpcclxuICAgICAgTWFuYWdlZFBvbGljeU5hbWU6IFJEU0Rhc2hib2FyZC1SRFMtUmVhZE9ubHlcclxuICAgICAgRGVzY3JpcHRpb246ICdSZWFkLW9ubHkgYWNjZXNzIHRvIFJEUyBmb3IgZGlzY292ZXJ5IGFuZCBtb25pdG9yaW5nJ1xyXG4gICAgICBQb2xpY3lEb2N1bWVudDpcclxuICAgICAgICBWZXJzaW9uOiAnMjAxMi0xMC0xNydcclxuICAgICAgICBTdGF0ZW1lbnQ6XHJcbiAgICAgICAgICAtIEVmZmVjdDogQWxsb3dcclxuICAgICAgICAgICAgQWN0aW9uOlxyXG4gICAgICAgICAgICAgIC0gJ3JkczpEZXNjcmliZSonXHJcbiAgICAgICAgICAgICAgLSAncmRzOkxpc3RUYWdzRm9yUmVzb3VyY2UnXHJcbiAgICAgICAgICAgIFJlc291cmNlOiAnKidcclxuXHJcbiAgIyBQb2xpY3k6IENsb3VkV2F0Y2ggUmVhZC1Pbmx5IEFjY2Vzc1xyXG4gIENsb3VkV2F0Y2hSZWFkT25seVBvbGljeTpcclxuICAgIFR5cGU6IEFXUzo6SUFNOjpNYW5hZ2VkUG9saWN5XHJcbiAgICBQcm9wZXJ0aWVzOlxyXG4gICAgICBNYW5hZ2VkUG9saWN5TmFtZTogUkRTRGFzaGJvYXJkLUNsb3VkV2F0Y2gtUmVhZE9ubHlcclxuICAgICAgRGVzY3JpcHRpb246ICdSZWFkLW9ubHkgYWNjZXNzIHRvIENsb3VkV2F0Y2ggbWV0cmljcydcclxuICAgICAgUG9saWN5RG9jdW1lbnQ6XHJcbiAgICAgICAgVmVyc2lvbjogJzIwMTItMTAtMTcnXHJcbiAgICAgICAgU3RhdGVtZW50OlxyXG4gICAgICAgICAgLSBFZmZlY3Q6IEFsbG93XHJcbiAgICAgICAgICAgIEFjdGlvbjpcclxuICAgICAgICAgICAgICAtICdjbG91ZHdhdGNoOkdldE1ldHJpY1N0YXRpc3RpY3MnXHJcbiAgICAgICAgICAgICAgLSAnY2xvdWR3YXRjaDpHZXRNZXRyaWNEYXRhJ1xyXG4gICAgICAgICAgICAgIC0gJ2Nsb3Vkd2F0Y2g6TGlzdE1ldHJpY3MnXHJcbiAgICAgICAgICAgIFJlc291cmNlOiAnKidcclxuXHJcbiAgIyBQb2xpY3k6IFJEUyBXcml0ZSBBY2Nlc3MgKE5vbi1Qcm9kdWN0aW9uIE9ubHkpXHJcbiAgUkRTV3JpdGVOb25Qcm9kUG9saWN5OlxyXG4gICAgVHlwZTogQVdTOjpJQU06Ok1hbmFnZWRQb2xpY3lcclxuICAgIFByb3BlcnRpZXM6XHJcbiAgICAgIE1hbmFnZWRQb2xpY3lOYW1lOiBSRFNEYXNoYm9hcmQtUkRTLVdyaXRlTm9uUHJvZFxyXG4gICAgICBEZXNjcmlwdGlvbjogJ1dyaXRlIGFjY2VzcyB0byBSRFMgZm9yIHNlbGYtc2VydmljZSBvcGVyYXRpb25zIChub24tcHJvZCBvbmx5KSdcclxuICAgICAgUG9saWN5RG9jdW1lbnQ6XHJcbiAgICAgICAgVmVyc2lvbjogJzIwMTItMTAtMTcnXHJcbiAgICAgICAgU3RhdGVtZW50OlxyXG4gICAgICAgICAgLSBFZmZlY3Q6IEFsbG93XHJcbiAgICAgICAgICAgIEFjdGlvbjpcclxuICAgICAgICAgICAgICAtICdyZHM6Q3JlYXRlREJTbmFwc2hvdCdcclxuICAgICAgICAgICAgICAtICdyZHM6UmVib290REJJbnN0YW5jZSdcclxuICAgICAgICAgICAgICAtICdyZHM6TW9kaWZ5REJJbnN0YW5jZSdcclxuICAgICAgICAgICAgUmVzb3VyY2U6ICcqJ1xyXG4gICAgICAgICAgICBDb25kaXRpb246XHJcbiAgICAgICAgICAgICAgU3RyaW5nTm90RXF1YWxzOlxyXG4gICAgICAgICAgICAgICAgJ2F3czpSZXNvdXJjZVRhZy9FbnZpcm9ubWVudCc6ICdQcm9kdWN0aW9uJ1xyXG5cclxuT3V0cHV0czpcclxuICBSb2xlQXJuOlxyXG4gICAgRGVzY3JpcHRpb246IEFSTiBvZiB0aGUgY3Jvc3MtYWNjb3VudCByb2xlXHJcbiAgICBWYWx1ZTogIUdldEF0dCBSRFNEYXNoYm9hcmRDcm9zc0FjY291bnRSb2xlLkFyblxyXG4gICAgRXhwb3J0OlxyXG4gICAgICBOYW1lOiBSRFNEYXNoYm9hcmRDcm9zc0FjY291bnRSb2xlQXJuXHJcbiAgXHJcbiAgUm9sZU5hbWU6XHJcbiAgICBEZXNjcmlwdGlvbjogTmFtZSBvZiB0aGUgY3Jvc3MtYWNjb3VudCByb2xlXHJcbiAgICBWYWx1ZTogIVJlZiBSRFNEYXNoYm9hcmRDcm9zc0FjY291bnRSb2xlXHJcbiAgICBFeHBvcnQ6XHJcbiAgICAgIE5hbWU6IFJEU0Rhc2hib2FyZENyb3NzQWNjb3VudFJvbGVOYW1lXHJcbmA7XHJcbiAgfVxyXG59XHJcbiJdfQ==