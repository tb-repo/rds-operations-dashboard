{"version":3,"file":"origin-validator.js","sourceRoot":"","sources":["../../src/security/origin-validator.ts"],"names":[],"mappings":"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"}