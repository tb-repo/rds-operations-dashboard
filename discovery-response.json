{"statusCode": 200, "body": "{\"total_instances\": 1, \"instances\": [{\"instance_id\": \"tb-pg-db1\", \"arn\": \"arn:aws:rds:ap-southeast-1:876595225096:db:tb-pg-db1\", \"account_id\": \"876595225096\", \"region\": \"ap-southeast-1\", \"engine\": \"postgres\", \"engine_version\": \"18.1\", \"instance_class\": \"db.t4g.micro\", \"storage_type\": \"gp3\", \"allocated_storage\": 20, \"iops\": 3000, \"storage_encrypted\": true, \"multi_az\": false, \"availability_zone\": \"ap-southeast-1c\", \"status\": \"available\", \"endpoint\": \"tb-pg-db1.cxu0o0sayujn.ap-southeast-1.rds.amazonaws.com\", \"port\": 6531, \"publicly_accessible\": false, \"vpc_id\": \"vpc-0b5c61dcb04e1ec90\", \"backup_retention_period\": 0, \"preferred_backup_window\": \"18:27-18:57\", \"latest_restorable_time\": null, \"preferred_maintenance_window\": \"thu:14:09-thu:14:39\", \"auto_minor_version_upgrade\": false, \"pending_modified_values\": {}, \"deletion_protection\": false, \"iam_database_authentication_enabled\": false, \"performance_insights_enabled\": true, \"tags\": {\"Project\": \"RDS-Operations-Dashboard\", \"Automation\": \"Manual\", \"ManagedBy\": \"TB-Account\", \"Schedule\": \"stopped\", \"CreatedDate\": \"2025-11-20\", \"Application\": \"RDS-Dashboard\", \"IS-ManagedBy\": \"Scheduler-Hub\"}, \"environment\": \"Unknown\", \"discovered_at\": \"2026-01-05T13:58:57.757835Z\", \"last_updated\": \"2026-01-05T13:58:57.757843Z\"}], \"accounts_scanned\": 1, \"accounts_attempted\": 2, \"regions_scanned\": 1, \"errors\": [{\"account_id\": \"817214535871\", \"type\": \"cross_account_access\", \"severity\": \"high\", \"error\": \"An error occurred (AccessDenied) when calling the AssumeRole operation: User: arn:aws:sts::876595225096:assumed-role/RDSDashboardLambdaRole/rds-discovery is not authorized to perform: sts:AssumeRole on resource: arn:aws:iam::817214535871:role/RDSDashboardCrossAccountRole\", \"remediation\": \"Cross-account role access denied. To fix:\\n            \\n            1. Create IAM role 'RDSDashboardCrossAccountRole' in account 817214535871 if it doesn't exist\\n            2. Update trust policy to allow account 876595225096 to assume it:\\n            \\n            {\\n              \\\"Version\\\": \\\"2012-10-17\\\",\\n              \\\"Statement\\\": [{\\n                \\\"Effect\\\": \\\"Allow\\\",\\n                \\\"Principal\\\": {\\\"AWS\\\": \\\"arn:aws:iam::876595225096:root\\\"},\\n                \\\"Action\\\": \\\"sts:AssumeRole\\\",\\n                \\\"Condition\\\": {\\\"StringEquals\\\": {\\\"sts:ExternalId\\\": \\\"rds-dashboard-unique-external-id\\\"}}\\n              }]\\n            }\\n            \\n            3. Attach RDS permissions policy:\\n            {\\n              \\\"Version\\\": \\\"2012-10-17\\\",\\n              \\\"Statement\\\": [{\\n                \\\"Effect\\\": \\\"Allow\\\",\\n                \\\"Action\\\": [\\n                  \\\"rds:Describe*\\\",\\n                  \\\"rds:List*\\\",\\n                  \\\"rds:StartDBInstance\\\",\\n                  \\\"rds:StopDBInstance\\\",\\n                  \\\"rds:RebootDBInstance\\\",\\n                  \\\"rds:CreateDBSnapshot\\\"\\n                ],\\n                \\\"Resource\\\": \\\"*\\\"\\n              }]\\n            }\\n            \\n            4. Deploy using CloudFormation template: infrastructure/cross-account-role.yaml\", \"timestamp\": \"2026-01-05T13:58:57.829728Z\"}], \"warnings\": [], \"discovery_timestamp\": \"2026-01-05T13:58:57.830249Z\", \"cross_account_enabled\": true, \"persistence\": {\"new_instances\": 1, \"updated_instances\": 0, \"unchanged_instances\": 0, \"deleted_instances\": 0, \"errors\": 1, \"total_processed\": 1}, \"execution_status\": \"completed_with_errors\"}"}