{"statusCode": 200, "body": "{\"total_instances\": 2, \"instances\": [{\"instance_id\": \"tb-pg-db1\", \"arn\": \"arn:aws:rds:ap-southeast-1:876595225096:db:tb-pg-db1\", \"account_id\": \"876595225096\", \"region\": \"ap-southeast-1\", \"engine\": \"postgres\", \"engine_version\": \"18.1\", \"instance_class\": \"db.t4g.micro\", \"storage_type\": \"gp3\", \"allocated_storage\": 20, \"iops\": 3000, \"storage_encrypted\": true, \"multi_az\": false, \"availability_zone\": \"ap-southeast-1c\", \"status\": \"stopped\", \"endpoint\": \"tb-pg-db1.cxu0o0sayujn.ap-southeast-1.rds.amazonaws.com\", \"port\": 6531, \"publicly_accessible\": false, \"vpc_id\": \"vpc-0b5c61dcb04e1ec90\", \"backup_retention_period\": 0, \"preferred_backup_window\": \"18:27-18:57\", \"latest_restorable_time\": null, \"preferred_maintenance_window\": \"thu:14:09-thu:14:39\", \"auto_minor_version_upgrade\": false, \"pending_modified_values\": {}, \"deletion_protection\": false, \"iam_database_authentication_enabled\": false, \"performance_insights_enabled\": true, \"tags\": {\"CreatedDate\": \"2025-11-20\", \"Project\": \"RDS-Operations-Dashboard\", \"Automation\": \"Manual\", \"ManagedBy\": \"TB-Account\", \"Application\": \"RDS-Dashboard\"}, \"environment\": \"Unknown\", \"discovered_at\": \"2025-12-08T14:08:37.835564Z\", \"last_updated\": \"2025-12-08T14:08:37.835571Z\"}, {\"instance_id\": \"database-1\", \"arn\": \"arn:aws:rds:eu-west-2:876595225096:db:database-1\", \"account_id\": \"876595225096\", \"region\": \"eu-west-2\", \"engine\": \"mysql\", \"engine_version\": \"8.0.43\", \"instance_class\": \"db.t4g.micro\", \"storage_type\": \"gp2\", \"allocated_storage\": 20, \"iops\": null, \"storage_encrypted\": true, \"multi_az\": false, \"availability_zone\": \"eu-west-2a\", \"status\": \"available\", \"endpoint\": \"database-1.cnu8q8a4wryp.eu-west-2.rds.amazonaws.com\", \"port\": 3306, \"publicly_accessible\": false, \"vpc_id\": \"vpc-0a2bd5437ed1aada7\", \"backup_retention_period\": 1, \"preferred_backup_window\": \"04:44-05:14\", \"latest_restorable_time\": \"2025-12-08T14:05:00+00:00\", \"preferred_maintenance_window\": \"mon:03:08-mon:03:38\", \"auto_minor_version_upgrade\": true, \"pending_modified_values\": {}, \"deletion_protection\": false, \"iam_database_authentication_enabled\": false, \"performance_insights_enabled\": false, \"tags\": {}, \"environment\": \"Unknown\", \"discovered_at\": \"2025-12-08T14:08:38.493082Z\", \"last_updated\": \"2025-12-08T14:08:38.493085Z\"}], \"accounts_scanned\": 1, \"accounts_attempted\": 3, \"regions_scanned\": 4, \"errors\": [{\"account_id\": \"123456789012\", \"type\": \"cross_account_access\", \"severity\": \"high\", \"error\": \"An error occurred (AccessDenied) when calling the AssumeRole operation: User: arn:aws:sts::876595225096:assumed-role/RDSDashboardLambdaRole/rds-discovery is not authorized to perform: sts:AssumeRole on resource: arn:aws:iam::123456789012:role/RDSDashboardCrossAccountRole\", \"remediation\": \"Cross-account role not accessible. To fix:\\n            1. Create IAM role 'RDSDashboardCrossAccountRole' in account 123456789012\\n            2. Add trust policy allowing account current to assume it\\n            3. Include ExternalId 'rds-dashboard-unique-id-12345' in trust policy\\n            4. Attach policy with rds:Describe* permissions\\n            \\n            Example trust policy:\\n            {\\n              \\\"Version\\\": \\\"2012-10-17\\\",\\n              \\\"Statement\\\": [{\\n                \\\"Effect\\\": \\\"Allow\\\",\\n                \\\"Principal\\\": {\\\"AWS\\\": \\\"arn:aws:iam::CURRENT_ACCOUNT:root\\\"},\\n                \\\"Action\\\": \\\"sts:AssumeRole\\\",\\n                \\\"Condition\\\": {\\\"StringEquals\\\": {\\\"sts:ExternalId\\\": \\\"rds-dashboard-unique-id-12345\\\"}}\\n              }]\\n            }\", \"timestamp\": \"2025-12-08T14:08:38.882643Z\"}, {\"account_id\": \"234567890123\", \"type\": \"cross_account_access\", \"severity\": \"high\", \"error\": \"An error occurred (AccessDenied) when calling the AssumeRole operation: User: arn:aws:sts::876595225096:assumed-role/RDSDashboardLambdaRole/rds-discovery is not authorized to perform: sts:AssumeRole on resource: arn:aws:iam::234567890123:role/RDSDashboardCrossAccountRole\", \"remediation\": \"Cross-account role not accessible. To fix:\\n            1. Create IAM role 'RDSDashboardCrossAccountRole' in account 234567890123\\n            2. Add trust policy allowing account current to assume it\\n            3. Include ExternalId 'rds-dashboard-unique-id-12345' in trust policy\\n            4. Attach policy with rds:Describe* permissions\\n            \\n            Example trust policy:\\n            {\\n              \\\"Version\\\": \\\"2012-10-17\\\",\\n              \\\"Statement\\\": [{\\n                \\\"Effect\\\": \\\"Allow\\\",\\n                \\\"Principal\\\": {\\\"AWS\\\": \\\"arn:aws:iam::CURRENT_ACCOUNT:root\\\"},\\n                \\\"Action\\\": \\\"sts:AssumeRole\\\",\\n                \\\"Condition\\\": {\\\"StringEquals\\\": {\\\"sts:ExternalId\\\": \\\"rds-dashboard-unique-id-12345\\\"}}\\n              }]\\n            }\", \"timestamp\": \"2025-12-08T14:08:38.943215Z\"}], \"warnings\": [], \"discovery_timestamp\": \"2025-12-08T14:08:38.943739Z\", \"cross_account_enabled\": true, \"persistence\": {\"new_instances\": 1, \"updated_instances\": 0, \"unchanged_instances\": 1, \"deleted_instances\": 0, \"errors\": 0, \"total_processed\": 2}, \"execution_status\": \"completed_with_errors\"}"}